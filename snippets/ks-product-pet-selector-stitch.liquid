{% comment %}
  Pet Selector - Stitch UI Pattern
  Simplified, modern pet selector based on Stitch reference design
  Max 3 pets, global style/font selection, per-pet upload
{% endcomment %}

{% comment %} Get max pets from product metafield (default: 1) {% endcomment %}
{% assign max_pets_from_metafield = product.metafields.custom.max_pets | default: 1 %}
{% assign max_pets_per_product = max_pets_from_metafield | plus: 0 %}

{% comment %} Ensure max_pets is within valid range (1-3) {% endcomment %}
{% if max_pets_per_product < 1 %}
  {% assign max_pets_per_product = 1 %}
{% elsif max_pets_per_product > 3 %}
  {% assign max_pets_per_product = 3 %}
{% endif %}

{% comment %} Only show for products with "custom" tag {% endcomment %}
{% assign has_custom_tag = false %}
{% for tag in product.tags %}
  {% if tag contains 'custom' or tag contains 'Custom' or tag contains 'CUSTOM' %}
    {% assign has_custom_tag = true %}
    {% break %}
  {% endif %}
{% endfor %}

{% if has_custom_tag %}
<div class="pet-selector-stitch"
     data-max-pets="{{ max_pets_per_product }}"
     data-product-id="{{ product.id }}"
     style="--pet-selector-primary: {{ scheme_button }}; --pet-selector-primary-text: {{ scheme_button_label }}; --pet-selector-text: {{ scheme_text }}; --pet-selector-background: {{ scheme_background }};">


  {% comment %} Pet Count Selector {% endcomment %}
  <div class="pet-selector__section">
    <h2 class="pet-selector__section-heading">Number of Pets</h2>
    <div class="pet-selector__count-grid">
      {% for i in (1..max_pets_per_product) %}
      <label class="pet-count-btn {% if i == 1 %}pet-count-btn--active{% endif %}">
        <span>{{ i }}</span>
        <input type="radio"
               name="pet-count"
               value="{{ i }}"
               {% if i == 1 %}checked{% endif %}
               data-pet-count-radio>
      </label>
      {% endfor %}
    </div>
  </div>

  {% comment %} Pet Details Section {% endcomment %}
  <div class="pet-selector__section">
    <h2 class="pet-selector__section-heading">Pet Details</h2>

    {% comment %} Dynamic pet sections (1-3 based on selection) {% endcomment %}
    <div class="pet-details-container" data-pet-details-container>
      {% for i in (1..3) %}
      <div class="pet-detail"
           data-pet-index="{{ i }}"
           {% if i > 1 %}style="display: none;"{% endif %}>

        <div class="pet-detail__row">
          <label class="pet-detail__name-label">
            <p class="pet-detail__label-text">
              {% if i == 1 %}Pet's Name{% else %}Pet {{ i }}'s Name{% endif %}
            </p>
            <input type="text"
                   class="pet-detail__name-input"
                   name="properties[Pet {{ i }} Name]"
                   placeholder="Enter name"
                   data-pet-name-input="{{ i }}">
          </label>

          <div class="pet-detail__buttons">
            <button type="button"
                    class="pet-detail__upload-btn"
                    data-pet-upload-btn="{{ i }}">
              Upload
              <input type="file"
                     accept="image/*"
                     class="pet-detail__file-input"
                     data-pet-file-input="{{ i }}">
            </button>
            <button type="button"
                    class="pet-detail__preview-btn"
                    data-pet-preview-btn="{{ i }}">
              Preview
            </button>
          </div>
        </div>

        <div class="pet-detail__checkbox-row">
          <label class="pet-detail__checkbox-label">
            <input type="checkbox"
                   class="pet-detail__checkbox"
                   data-existing-print-checkbox="{{ i }}">
            <span>Use Existing Perkie Print</span>
          </label>
        </div>

        <div class="pet-detail__order-input"
             data-order-number-input="{{ i }}"
             style="display: none;">
          <input type="text"
                 class="pet-detail__order-number"
                 placeholder="Enter previous order number"
                 name="properties[Pet {{ i }} Order Number]"
                 data-order-number-field="{{ i }}">
        </div>

      </div>
      {% endfor %}
    </div>
  </div>

  {% comment %} Style Selector {% endcomment %}
  <div class="pet-selector__section">
    <h2 class="pet-selector__section-heading">Choose Style</h2>
    <div class="style-selector__grid">

      {% comment %} B&W Style {% endcomment %}
      <label class="style-card">
        <input type="radio"
               name="properties[Style]"
               value="enhancedblackwhite"
               data-style-radio="enhancedblackwhite">
        <div class="style-card__content">
          <div class="style-card__image-wrapper">
            {% if block.settings.style_preview_bw != blank %}
              <img src="{{ block.settings.style_preview_bw | image_url: width: 320 }}"
                   alt="Black & White style preview"
                   class="style-card__image">
            {% else %}
              <img src="{{ 'pet-bw-preview.jpg' | asset_url }}"
                   alt="Black & White style preview"
                   class="style-card__image">
            {% endif %}
          </div>
          <p class="style-card__label">Black & White</p>
        </div>
        {% comment %}
        <div class="style-card__tooltip">
          A striking black and white conversion that highlights your pet's features.
        </div>
        {% endcomment %}
      </label>

      {% comment %} Color Style {% endcomment %}
      <label class="style-card">
        <input type="radio"
               name="properties[Style]"
               value="color"
               data-style-radio="color">
        <div class="style-card__content">
          <div class="style-card__image-wrapper">
            {% if block.settings.style_preview_color != blank %}
              <img src="{{ block.settings.style_preview_color | image_url: width: 320 }}"
                   alt="Color style preview"
                   class="style-card__image">
            {% else %}
              <img src="{{ 'pet-color-preview.jpg' | asset_url }}"
                   alt="Color style preview"
                   class="style-card__image">
            {% endif %}
          </div>
          <p class="style-card__label">Color</p>
        </div>
        {% comment %}
        <div class="style-card__tooltip">
          Your pet's photo is used as is, preserving the original colors and lighting.
        </div>
        {% endcomment %}
      </label>

      {% comment %} Modern (Ink Wash) Style {% endcomment %}
      <label class="style-card style-card--active">
        <input type="radio"
               name="properties[Style]"
               value="modern"
               checked
               data-style-radio="modern">
        <div class="style-card__content">
          <div class="style-card__image-wrapper">
            {% if block.settings.style_preview_modern != blank %}
              <img src="{{ block.settings.style_preview_modern | image_url: width: 320 }}"
                   alt="Modern style preview"
                   class="style-card__image">
            {% else %}
              <img src="{{ 'pet-modern-preview.jpg' | asset_url }}"
                   alt="Modern style preview"
                   class="style-card__image">
            {% endif %}
          </div>
          <p class="style-card__label">Modern</p>
        </div>
        {% comment %}
        <div class="style-card__tooltip">
          A clean, contemporary Asian ink wash style with flowing brushstrokes.
        </div>
        {% endcomment %}
      </label>

      {% comment %} Sketch (Pen & Marker) Style {% endcomment %}
      <label class="style-card">
        <input type="radio"
               name="properties[Style]"
               value="sketch"
               data-style-radio="sketch">
        <div class="style-card__content">
          <div class="style-card__image-wrapper">
            {% if block.settings.style_preview_sketch != blank %}
              <img src="{{ block.settings.style_preview_sketch | image_url: width: 320 }}"
                   alt="Sketch style preview"
                   class="style-card__image">
            {% else %}
              <img src="{{ 'pet-sketch-preview.jpg' | asset_url }}"
                   alt="Sketch style preview"
                   class="style-card__image">
            {% endif %}
          </div>
          <p class="style-card__label">Sketch</p>
        </div>
        {% comment %}
        <div class="style-card__tooltip">
          Contemporary pen and marker illustration with bold lines and vibrant colors.
        </div>
        {% endcomment %}
      </label>

    </div>
  </div>

  {% comment %} Font Selector - Only show if product supports font styles {% endcomment %}
  {% if product.metafields.custom.supports_font_styles == true %}
  <div class="pet-selector__section">
    <h2 class="pet-selector__section-heading">Choose Font</h2>
    <div class="font-selector__grid">

      {% comment %} No Text Option {% endcomment %}
      <label class="font-card">
        <input type="radio"
               name="properties[Font]"
               value="no-text"
               data-font-radio="no-text">
        <div class="font-card__content">
          <p class="font-card__title">No Text</p>
          <div class="font-card__preview font-card__preview--icon">
            <svg class="font-card__no-text-icon" viewBox="0 0 24 24">
              <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
          </div>
        </div>
      </label>

      {% comment %} Preppy Font (with borders) {% endcomment %}
      <label class="font-card font-card--active">
        <input type="radio"
               name="properties[Font]"
               value="preppy"
               checked
               data-font-radio="preppy">
        <div class="font-card__content">
          <p class="font-card__title">Preppy</p>
          <p class="font-card__preview font-card__preview--preppy" data-font-preview>
            <span class="font-preview-text"></span>
          </p>
        </div>
      </label>

      {% comment %} Classic Font {% endcomment %}
      <label class="font-card">
        <input type="radio"
               name="properties[Font]"
               value="classic"
               data-font-radio="classic">
        <div class="font-card__content">
          <p class="font-card__title">Classic</p>
          <p class="font-card__preview font-card__preview--classic" data-font-preview>
            <span class="font-preview-text"></span>
          </p>
        </div>
      </label>

      {% comment %} Playful Font {% endcomment %}
      <label class="font-card">
        <input type="radio"
               name="properties[Font]"
               value="playful"
               data-font-radio="playful">
        <div class="font-card__content">
          <p class="font-card__title">Playful</p>
          <p class="font-card__preview font-card__preview--playful" data-font-preview>
            <span class="font-preview-text"></span>
          </p>
        </div>
      </label>

      {% comment %} Elegant Font {% endcomment %}
      <label class="font-card">
        <input type="radio"
               name="properties[Font]"
               value="elegant"
               data-font-radio="elegant">
        <div class="font-card__content">
          <p class="font-card__title">Elegant</p>
          <p class="font-card__preview font-card__preview--elegant" data-font-preview>
            <span class="font-preview-text"></span>
          </p>
        </div>
      </label>

      {% comment %} Trend Font {% endcomment %}
      <label class="font-card">
        <input type="radio"
               name="properties[Font]"
               value="trend"
               data-font-radio="trend">
        <div class="font-card__content">
          <p class="font-card__title">Trend</p>
          <p class="font-card__preview font-card__preview--trend" data-font-preview>
            <span class="font-preview-text"></span>
          </p>
        </div>
      </label>

    </div>
  </div>
  {% endif %}

</div>

{% comment %} Get color scheme from block settings {% endcomment %}
{% assign scheme_id = block.settings.color_scheme | default: 'scheme-1' %}
{% assign scheme = settings.color_schemes[scheme_id].settings %}

{% comment %} Extract color values with fallbacks {% endcomment %}
{% assign scheme_background = scheme.background | default: '#ffffff' %}
{% assign scheme_text = scheme.text | default: '#000000' %}
{% assign scheme_button = scheme.button | default: '#ebff7a' %}
{% assign scheme_button_label = scheme.button_label | default: '#461312' %}

<style>
/* Google Fonts Import for Font Selector */
@import url('https://fonts.googleapis.com/css2?family=Libre+Caslon+Text:ital,wght@0,400;0,700;1,400&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Rampart+One&family=Ms+Madi&family=Fascinate&display=swap');

/* Pet Selector - Stitch Pattern Styles */
/* Color variables set via inline style on container for instant theme editor updates */

.pet-selector-stitch {
  /* Theme color variables are set via inline style attribute above */
  /* Static gray scale variables defined here */
  --pet-selector-gray-50: #f9fafb;
  --pet-selector-gray-100: #f3f4f6;
  --pet-selector-gray-200: #e5e7eb;
  --pet-selector-gray-300: #d1d5db;
  --pet-selector-gray-400: #9ca3af;
  --pet-selector-gray-500: #6b7280;
  --pet-selector-gray-600: #4b5563;
  --pet-selector-gray-700: #374151;
  --pet-selector-gray-800: #1f2937;
  --pet-selector-gray-900: #111827;
}

.pet-selector-stitch {
  max-width: 960px;
  margin: 0 auto;
  padding: 1rem;
  color: var(--pet-selector-text);
}

.pet-selector__section {
  margin-bottom: 1rem;
  padding: 1.5rem;
  border: 1px solid var(--pet-selector-gray-200);
  border-radius: 0.75rem;
  background-color: var(--pet-selector-background);
}

/* Unified section heading style - all section headers use this */
.pet-selector__section-heading {
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--pet-selector-text);
  margin: 0 0 0.75rem 0;
  line-height: 1.3;
}

/* DEPRECATED: Use .pet-selector__section-heading instead */
.pet-selector__label {
  display: block;
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--pet-selector-text);
  margin-bottom: 0.75rem;
}

/* DEPRECATED: Use .pet-selector__section-heading instead */
.pet-selector__heading {
  font-size: 1.375rem;
  font-weight: 700;
  color: var(--pet-selector-text);
  margin: 0 0 1.5rem 0;
}

/* Pet Count Selector */
.pet-selector__count-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.5rem;
}

.pet-count-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 3.5rem;
  cursor: pointer;
  border-radius: 0.5rem;
  background-color: var(--pet-selector-gray-100);
  color: var(--pet-selector-gray-500);
  font-size: 1rem;
  font-weight: 600;
  transition: all 0.2s;
  border: 2px solid transparent;
}

.pet-count-btn input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.pet-count-btn--active,
.pet-count-btn:has(input:checked) {
  background-color: var(--pet-selector-background);
  color: var(--pet-selector-text);
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  border-color: #ff5964;
}

/* Pet Details */
.pet-details-container {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.pet-detail {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.pet-detail__row {
  display: flex;
  gap: 1rem;
  align-items: flex-end;
}

.pet-detail__name-label {
  flex: 1;
  min-width: 0;
}

.pet-detail__label-text {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--pet-selector-text);
  margin: 0 0 0.5rem 0;
}

.pet-detail__name-input {
  width: 100%;
  height: 3rem;
  padding: 0 0.75rem;
  border: 1px solid var(--pet-selector-gray-300);
  border-radius: 0;
  font-size: 0.875rem;
  color: var(--pet-selector-text);
  background-color: var(--pet-selector-background);
}

.pet-detail__name-input:focus {
  outline: none;
  border-color: #ff5964;
  box-shadow: 0 0 0 2px rgba(255, 89, 100, 0.2);
}

.pet-detail__buttons {
  display: flex;
  gap: 0.5rem;
  flex-shrink: 0;
}

.pet-detail__upload-btn,
.pet-detail__preview-btn {
  position: relative;
  height: 3rem;
  padding: 0 1.25rem;
  background-color: var(--pet-selector-gray-100);
  border: none;
  border-radius: 40px;
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--pet-selector-gray-700);
  cursor: pointer;
  transition: background-color 0.2s;
}

.pet-detail__upload-btn:hover,
.pet-detail__preview-btn:hover {
  background-color: var(--pet-selector-gray-200);
}

.pet-detail__file-input {
  position: absolute;
  inset: 0;
  opacity: 0;
  cursor: pointer;
}

.pet-detail__checkbox-row {
  margin-top: 0.5rem;
}

.pet-detail__checkbox-label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--pet-selector-gray-700);
}

.pet-detail__checkbox {
  width: 1rem;
  height: 1rem;
  accent-color: #ff5964;
}

.pet-detail__order-input {
  margin-top: 0.5rem;
}

.pet-detail__order-number {
  width: 100%;
  height: 3rem;
  padding: 0 0.75rem;
  border: 1px solid var(--pet-selector-gray-300);
  border-radius: 0;
  font-size: 0.875rem;
  color: var(--pet-selector-text);
  background-color: var(--pet-selector-background);
}

.pet-detail__order-number:focus {
  outline: none;
  border-color: #ff5964;
  box-shadow: 0 0 0 2px rgba(255, 89, 100, 0.2);
}

/* Style Selector */
.style-selector__grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
}

@media (min-width: 640px) {
  .style-selector__grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .style-selector__grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

.style-card {
  position: relative;
  cursor: pointer;
  display: block;
}

.style-card input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.style-card__content {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  width: 100%;
}

.style-card--active .style-card__content .style-card__image-wrapper,
.style-card:has(input:checked) .style-card__content .style-card__image-wrapper {
  border-color: #ff5964;
}

.style-card__image-wrapper {
  position: relative;
  width: 100%;
  aspect-ratio: 1;
  border: 2px solid transparent;
  border-radius: 0.5rem;
  overflow: hidden;
  transition: all 0.2s;
}

.style-card__image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.style-card__label {
  font-size: 0.875rem;
  font-weight: 600;
  color: #000000;
  text-align: center;
  margin: 0;
  padding: 0;
}

/* Tooltip styles commented out
.style-card__tooltip {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: 0.5rem;
  padding: 0.5rem 0.75rem;
  background-color: #ffffff;
  color: #000000;
  font-size: 0.875rem;
  border-radius: 0.375rem;
  border: 1px solid #e5e7eb;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
  max-width: 16rem;
  white-space: normal;
}

.style-card:hover .style-card__tooltip {
  opacity: 1;
}
*/

/* Font Selector */
.font-selector__grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
}

@media (min-width: 640px) {
  .font-selector__grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (min-width: 1024px) {
  .font-selector__grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

.font-card {
  cursor: pointer;
  display: block;
}

.font-card input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.font-card__content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem;
  background-color: var(--pet-selector-background);
  border: 1px solid var(--pet-selector-gray-200);
  border-radius: 0.5rem;
  transition: all 0.2s;
  min-height: 7rem;
}

.font-card--active .font-card__content,
.font-card:has(input:checked) .font-card__content {
  border-color: #ff5964;
  box-shadow: 0 0 0 2px rgba(255, 89, 100, 0.3);
}

.font-card__title {
  font-size: 1rem;
  font-weight: 600;
  color: var(--pet-selector-gray-800);
  margin: 0;
}

.font-card__preview {
  font-size: 1.5rem;
  color: var(--pet-selector-gray-500);
  margin: 0;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
}

.font-card__preview--icon {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 2.25rem;
}

.font-card__no-text-icon {
  width: 2rem;
  height: 2rem;
  fill: var(--pet-selector-gray-400);
}

/* Font-specific styles */
.font-card__preview--preppy {
  font-family: 'Libre Caslon Text', 'Garamond', serif;
  text-decoration: underline overline;
  text-decoration-color: rgba(0, 0, 0, 0.5);
  text-decoration-thickness: 2px;
  text-underline-offset: 4px;
}

.font-card__preview--classic {
  font-family: 'Merriweather', serif;
}

.font-card__preview--playful {
  font-family: 'Rampart One', cursive;
}

.font-card__preview--elegant {
  font-family: 'Ms Madi', 'Sacramento', cursive;
}

.font-card__preview--trend {
  font-family: 'Fascinate', 'Rampart One', cursive;
}

/* Mobile Responsiveness */
@media (max-width: 639px) {
  .pet-detail__row {
    flex-direction: column;
    align-items: stretch;
  }

  .pet-detail__buttons {
    width: 100%;
    justify-content: space-between;
  }

  .pet-detail__upload-btn,
  .pet-detail__preview-btn {
    flex: 1;
  }
}
</style>

<script>
// Pet Selector Stitch - JavaScript
(function() {
  const container = document.querySelector('.pet-selector-stitch');
  if (!container) return;

  const maxPets = parseInt(container.dataset.maxPets) || 1;
  const petDetailsContainer = container.querySelector('[data-pet-details-container]');
  const countRadios = container.querySelectorAll('[data-pet-count-radio]');
  const fontPreviews = container.querySelectorAll('[data-font-preview]');

  // Update visible pet sections based on count
  function updatePetSections(count) {
    const petDetails = petDetailsContainer.querySelectorAll('.pet-detail');
    petDetails.forEach((detail, index) => {
      if (index < count) {
        detail.style.display = '';
      } else {
        detail.style.display = 'none';
      }
    });

    // Update pet count buttons
    const countBtns = container.querySelectorAll('.pet-count-btn');
    countBtns.forEach((btn) => {
      btn.classList.remove('pet-count-btn--active');
      if (btn.querySelector('input').checked) {
        btn.classList.add('pet-count-btn--active');
      }
    });

    updateFontPreviews();
  }

  // Update font previews with ampersand formatting (matches old font-selector)
  function updateFontPreviews() {
    const visiblePets = [...petDetailsContainer.querySelectorAll('.pet-detail')]
      .filter(detail => detail.style.display !== 'none');

    const petNames = visiblePets.map(detail => {
      const input = detail.querySelector('[data-pet-name-input]');
      return input.value.trim() || `Pet ${detail.dataset.petIndex}`;
    });

    // Format names with ampersand logic (matches PetNameFormatter)
    let previewText = '';
    if (petNames.length === 0) {
      previewText = '';
    } else if (petNames.length === 1) {
      previewText = petNames[0];
    } else if (petNames.length === 2) {
      // 2 pets: "Sam & Buddy"
      previewText = petNames[0] + ' & ' + petNames[1];
    } else {
      // 3+ pets: "Sam, Buddy & Max" (no Oxford comma)
      const lastPet = petNames[petNames.length - 1];
      const otherPets = petNames.slice(0, -1);
      previewText = otherPets.join(', ') + ' & ' + lastPet;
    }

    fontPreviews.forEach(preview => {
      const textSpan = preview.querySelector('.font-preview-text');
      if (textSpan) {
        textSpan.textContent = previewText;
      }
    });
  }

  // Pet count change listener
  countRadios.forEach(radio => {
    radio.addEventListener('change', (e) => {
      const count = parseInt(e.target.value);
      updatePetSections(count);
    });
  });

  // Pet name input listeners
  const nameInputs = container.querySelectorAll('[data-pet-name-input]');
  nameInputs.forEach(input => {
    input.addEventListener('input', updateFontPreviews);
  });

  // Existing Perkie Print checkbox listeners
  for (let i = 1; i <= 3; i++) {
    const checkbox = container.querySelector(`[data-existing-print-checkbox="${i}"]`);
    const orderInput = container.querySelector(`[data-order-number-input="${i}"]`);

    if (checkbox && orderInput) {
      checkbox.addEventListener('change', () => {
        orderInput.style.display = checkbox.checked ? '' : 'none';
      });
    }
  }

  // Style card click handler
  const styleCards = container.querySelectorAll('.style-card');
  styleCards.forEach(card => {
    card.addEventListener('click', () => {
      styleCards.forEach(c => c.classList.remove('style-card--active'));
      card.classList.add('style-card--active');
    });
  });

  // Font card click handler
  const fontCards = container.querySelectorAll('.font-card');
  fontCards.forEach(card => {
    card.addEventListener('click', () => {
      fontCards.forEach(c => c.classList.remove('font-card--active'));
      card.classList.add('font-card--active');
    });
  });

  // Initialize
  updatePetSections(1);
  updateFontPreviews();
})();
</script>

{% endif %}
