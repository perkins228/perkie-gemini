ğŸ”§ Deploying Storage Upload Error Fix...
ğŸ“ This deployment fixes:
   - Safari data URL parsing issues
   - Proper error classification (400/413/500/503)
   - Enhanced validation and logging

ğŸš€ Deploying to production...
Building using Dockerfile and deploying container to Cloud Run service [inspirenet-bg-removal-api] in project [perkieprints-processing] region [us-central1]
Building and deploying...
Uploading sources............done
Building Container...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done
Setting IAM Policy................done
Creating Revision.................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done
Routing traffic.....done
Done.
Service [inspirenet-bg-removal-api] revision [inspirenet-bg-removal-api-00097-7zt] has been deployed and is serving 100 percent of traffic.
Service URL: https://inspirenet-bg-removal-api-725543555429.us-central1.run.app

âœ… Deployment complete!
â±ï¸  Deployment took 1058 seconds

ğŸ§ª Running post-deployment tests...

1ï¸âƒ£  Testing health endpoint...
   âœ… Health check passed

2ï¸âƒ£  Testing model info endpoint...
   âœ… Model info retrieved successfully

3ï¸âƒ£  Testing storage upload endpoint with valid data...
   âœ… Storage upload with valid data succeeded
   ğŸ“ Response: {"urls":{"original":"https://storage.googleapis.com/perkieprints-customer-images/orders/test-deploy-...

4ï¸âƒ£  Testing storage upload error handling (malformed data)...
   âœ… Error handling works correctly (returned 400 for invalid data)

5ï¸âƒ£  Testing warmup endpoint (may take 30-60s on cold start)...
   âœ… Warmup succeeded in 68 seconds

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ‰ Storage Fix Deployment Complete!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Deployment Summary:
   â€¢ Total deployment time: 1058s
   â€¢ Warmup time: 68s
   â€¢ Service: inspirenet-bg-removal-api
   â€¢ Region: us-central1
   â€¢ URL: https://inspirenet-bg-removal-api-725543555429.us-central1.run.app

âœ… All critical tests passed!

ğŸ“‹ Next Steps:
   1. Monitor Cloud Run logs for 1 hour
   2. Test with Safari on macOS (manual)
   3. Watch for 500 errors on /api/storage/upload

ğŸ” Monitor logs with:
   gcloud logging read "resource.type=cloud_run_revision AND resource.labels.service_name=inspirenet-bg-removal-api" --limit=50 --format=json

ğŸ”„ Rollback if needed:
   gcloud run services update-traffic inspirenet-bg-removal-api --to-revisions=PREVIOUS_REVISION=100 --region=us-central1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
