{%- style -%}
  #ks-contact-form-{{ section.id }} {
    padding-top: {{ section.settings.pt | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.pb | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    #ks-contact-form-{{ section.id }} {
      padding-top: {{ section.settings.pt }}px;
      padding-bottom: {{ section.settings.pb }}px;
    }
  }
{% endstyle %}

<div 
  id="ks-contact-form-{{ section.id }}"
  class="ks-contact-form contact color-{{ section.settings.color_scheme }} gradient">

  <div 
    class="page-width"  
    style="max-width: {{ section.settings.page_width | append: 'px' }}">

      <div class="ks-section-header">
      {%- unless section.settings.title == blank -%}
        <h2 
          class="
            title title-wrapper--no-top-margin inline-richtext 
            {{ section.settings.heading_size }}
            {% if settings.animations_reveal_on_scroll %}scroll-trigger animate--slide-in{% endif %}
          ">
          {{ section.settings.title }}
        </h2>
      {%- endunless -%}
      {%- unless section.settings.description == blank -%}
        <div class="description rte {{ section.settings.description_size }} {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
          {{ section.settings.description }}
        </div>
      {%- endunless -%}
    </div>

    {%- liquid
      assign contact_form_class = 'isolate'
      if settings.animations_reveal_on_scroll
        assign contact_form_class = 'isolate scroll-trigger animate--slide-in'
      endif
    -%}
    {%- form 'contact', id: 'ContactForm', class: contact_form_class -%}
      {%- if form.posted_successfully? -%}
        <h2 class="form-status form-status-list form__message" tabindex="-1" autofocus>
          {{- 'icon-success.svg' | inline_asset_content -}}
          {{ 'templates.contact.form.post_success' | t }}
        </h2>
      {%- elsif form.errors -%}
        <div class="form__message">
          <h2 class="form-status caption-large text-body" role="alert" tabindex="-1" autofocus>
            {{- 'icon-error.svg' | inline_asset_content -}}
            {{ 'templates.contact.form.error_heading' | t }}
          </h2>
        </div>
        <ul class="form-status-list caption-large" role="list">
          <li>
            <a href="#ContactForm-email" class="link">
              {{ form.errors.translated_fields.email | capitalize }}
              {{ form.errors.messages.email }}
            </a>
          </li>
        </ul>
      {%- endif -%}

      <div class="contact__fields">
        {% for block in section.blocks %}
          {% if block.type == 'text' %}
            <div class="field-other" {{ block.shopify_attributes }}>
              {% unless block.settings.heading == blank %}
                <h3 class="title mb-2 {{ block.settings.heading_size }}">
                  {{ block.settings.heading }}
                </h3>
              {% endunless %}
              {% unless block.settings.description == blank %}
                <div class="description rte">
                  {{ block.settings.description }}
                </div>
              {% endunless %}
            </div>
          {% elsif block.type == 'email' %}
            <div class="field" {{ block.shopify_attributes }}>
              <input
                autocomplete="email"
                type="email"
                id="ContactForm-email"
                class="field__input"
                name="contact[email]"
                spellcheck="false"
                autocapitalize="off"
                value="{% if form.email %}{{ form.email }}{% elsif customer %}{{ customer.email }}{% endif %}"
                {% if block.settings.required %}
                  required
                {% endif %}
                placeholder="{{ block.settings.label }}">
              <label class="field__label" for="ContactForm-email">
                {{ block.settings.label }}
                {% if block.settings.required %}
                  <span aria-hidden="true">*</span>
                {% endif %}
              </label>
            </div>
          {% elsif block.type == 'phone' %}
            <div class="field" {{ block.shopify_attributes }}>
              <Input
                type="tel"
                id="ContactForm-phone"
                class="field__input"
                name="contact[{{ 'templates.contact.form.phone' | t }}]"
                pattern="[0-9\-]*"
                autocomplete="tel"
                value="{% if form.phone %}{{ form.phone }}{% elsif customer %}{{ customer.phone }}{% endif %}"
                placeholder=" {{ block.settings.label }}"
                {% if block.settings.required %}
                  required
                {% endif %}>
              <label class="field__label" for="ContactForm-phone">
                {{ block.settings.label }}
                {% if block.settings.required %}
                  <span aria-hidden="true">*</span>
                {% endif %}
              </label>
            </div>
          {% elsif block.type == 'textarea' %}
            <div class="field" {{ block.shopify_attributes }}>
              <textarea
                rows="10"
                id="ContactForm-{{ block.settings.label | handleize }}"
                class="text-area field__input"
                name="contact[{{ block.settings.label }}]"
                placeholder="{{ block.settings.label }}"
                style="min-height: {{ block.settings.min_height }}rem;" 
                required>
                {{- form.body -}}
              </textarea>
              <label class="form__label field__label" for="ContactForm-{{ block.settings.label | handleize }}">
                {{ block.settings.label }}
              </label>
            </div>
          {% elsif block.type == 'input' %}
            <div class="field" {{ block.shopify_attributes }}>
              <input
                class="field__input"
                type="text"
                id="ContactForm-{{ block.settings.label | handleize }}"
                name="contact[{{ block.settings.label }}]"
                placeholder="{{ block.settings.label }}"
                {% if block.settings.required %}
                  required
                {% endif %}>
              <label class="field__label" for="ContactForm-{{ block.settings.label | handleize }}">
                {{ block.settings.label }}
                {% if block.settings.required %}
                  <span aria-hidden="true">*</span>
                {% endif %}
              </label>
            </div>
          {% elsif block.type == 'date' %}
            <div class="field" {{ block.shopify_attributes }}>
              <input
                class="field__input"
                type="date"
                id="ContactForm-{{ block.settings.label | handleize }}"
                name="contact[{{ block.settings.label }}]"
                placeholder="{{ block.settings.label }}"
                {% if block.settings.required %}
                  required
                {% endif %}>
              <label class="field__label" for="ContactForm-{{ block.settings.label | handleize }}">
                {{ block.settings.label }}
                {% if block.settings.required %}
                  <span aria-hidden="true">*</span>
                {% endif %}
              </label>
            </div>
          {% elsif block.type == 'select' %}
            <div class="field-other" {{ block.shopify_attributes }}>
              {% assign options = block.settings.options | split: ',' %}
              <label class="form__label" for="ContactForm-{{ block.settings.label | handleize }}">
                {{ block.settings.label }}
              </label>
              <div class="select">
                <select 
                  class="select__select"
                  id="ContactForm-{{ block.settings.label | handleize }}"
                  name="contact[{{ block.settings.label | handleize }}]">
                  {% if block.settings.required %}required{% endif %}>
                  {% for option in options %}
                    <option value="{{ option }}">
                      {{ option }}
                    </option>
                  {% endfor %}
                </select>
                <span class="svg-wrapper">
                  {{- 'icon-caret.svg' | inline_asset_content -}}
                </span>
              </div>
            </div>
          {% elsif block.type == 'checkbox' %}
            <div class="field-other" {{ block.shopify_attributes }}>
              {% assign options = block.settings.options | split: ',' %}
              <p class="" style="margin: 0 0 .25rem;">
                {{ block.settings.label }}
              </p>
              {% for option in options %}
                <div class="">
                  <input 
                    id="input-{{ block.id }}-{{ forloop.index }}"
                    class="" 
                    type="checkbox" 
                    value="{{ option }}"
                    name="contact[{{ block.settings.label | handleize }}]">
                  <label for="input-{{ block.id }}-{{ forloop.index }}" class="">
                    {{ option }}
                  </label>
                </div>
              {% endfor %}
            </div>
          {% elsif block.type == 'radio' %}
            <div class="field-other" {{ block.shopify_attributes }}>
              {% assign options = block.settings.options | split: ',' %}
              <p class="" style="margin: 0 0 .25rem;">
                {{ block.settings.label }}
              </p>
              {% for option in options %}
                <div class="">
                  <input 
                    id="input-{{ block.id }}-{{ forloop.index }}"
                    class="" 
                    type="radio" 
                    value="{{ option }}"
                    name="contact[{{ block.settings.label | handleize }}]">
                  <label for="input-{{ block.id }}-{{ forloop.index }}" class="">
                    {{ option }}
                  </label>
                </div>
              {% endfor %}
            </div>
          {% elsif block.type == 'separator' %}
            <hr 
              class="" 
              style="
                opacity: {{ block.settings.opacity }};
                margin-top: {{ block.settings.mt }}rem;
                margin-bottom: {{ block.settings.mb }}rem;">
          {% elsif block.type == 'button' %}
            <div class="field-other" {{ block.shopify_attributes }}>
              <button type="submit" class="button" style="{% if block.settings.full_width %}width: 100%;{% endif %}">
                {{ 'templates.contact.form.send' | t }}
              </button>
            </div>
          {% endif %}
        {% endfor %}
      </div>

    {%- endform -%}

  </div>
</div>

{% schema %}
{
  "name": "KS - Contact Form Builder",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "General"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "page_width",
      "label": "Page width (px)",
      "default": "900",
      "info": "Leave empty to use the global \"page-width\"."
    },
    {
      "type": "inline_richtext",
      "id": "title",
      "label": "Heading",
      "default": "Contact Us",
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "options": [
        { "value": "h2", "label": "Small" },
        { "value": "h1", "label": "Medium" },
        { "value": "h0", "label": "Large" },
        { "value": "hxl", "label": "Extra large" },
        { "value": "hxxl", "label": "Extra extra large" }
      ],
      "default": "h1"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>An optional description for this section</p>",
    },
    {
      "type": "select",
      "id": "description_size",
      "label": "Description size",
      "default": "fs-md",
      "options": [
        { "value": "fs-xs", "label": "xs" },
        { "value": "fs-sm", "label": "sm" },
        { "value": "fs-md", "label": "md" },
        { "value": "fs-lg", "label": "lg" },
        { "value": "fs-xl", "label": "xl" }
      ]
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "pt",
      "label": "Top",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 36,
      "unit": "px",
    },
    {
      "type": "range",
      "id": "pb",
      "label": "Bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 36,
      "unit": "px",
    }
  ],
  "blocks": [
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Your Heading",
          "info": "Leave empty to disable"
        },
        {
          "type": "select",
          "id": "heading_size",
          "options": [
            { "value": "h2", "label": "t:sections.all.heading_size.options__1.label" },
            { "value": "h1", "label": "t:sections.all.heading_size.options__2.label" },
            { "value": "h0", "label": "t:sections.all.heading_size.options__3.label" }
          ],
          "default": "h2",
          "label": "t:sections.all.heading_size.label"
        },
        {
          "type": "richtext",
          "id": "description",
          "default": "<p>Some option description goes here</p>",
          "label": "Description"
        }
      ]
    },
    {
      "type": "email",
      "name": "Email",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Your Email"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": true,
          "info": "Disable this setting in case this field is optional"
        }
      ]
    },
    {
      "type": "phone",
      "name": "Phone",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Phone number"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": false,
          "info": "Disable this setting in case this field is optional"
        }
      ]
    },
    {
      "type": "textarea",
      "name": "Textarea",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Your Message"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": true,
          "info": "Disable this setting in case this field is optional"
        },
        {
          "type": "range",
          "id": "min_height",
          "label": "Min height",
          "default": 20,
          "min": 10,
          "max": 40,
          "unit": "rem"
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "full_width",
          "label": "Full width",
          "default": true
        }
      ]
    },
    {
      "type": "input",
      "name": "Input",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Your Name"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": true,
          "info": "Disable this setting in case this field is optional"
        }
      ]
    },
    {
      "type": "date",
      "name": "Date",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Date"
        },
        {
          "type": "checkbox",
          "id": "required",
          "label": "Required",
          "default": false,
          "info": "Disable this setting in case this field is optional"
        }
      ]
    },
    {
      "type": "separator",
      "name": "Separator",
      "settings": [
        {
          "type": "range",
          "id": "opacity",
          "label": "Border opacity",
          "min": 0,
          "max": 1,
          "step": 0.1,
          "default": 0.2
        },
        {
          "type": "range",
          "id": "mt",
          "label": "Margin top",
          "min": 0,
          "max": 7,
          "step": 1,
          "default": 2
        },
        {
          "type": "range",
          "id": "mb",
          "label": "Margin bottom",
          "min": 0,
          "max": 7,
          "step": 1,
          "default": 2
        }
      ]
    },
    {
      "type": "select",
      "name": "Select",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Planet"
        },
        {
          "type": "html",
          "id": "options",
          "label": "Options",
          "default": "Earth, Mars, Venus",
          "info": "Comma separated list of options. E.g: Earth, Mars, Venus"
        }
      ]
    },
    {
      "type": "checkbox",
      "name": "Checkbox",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Country"
        },
        {
          "type": "html",
          "id": "options",
          "label": "Options",
          "default": "United States, Canada, France",
          "info": "Comma separated list of options. E.g: United States, Canada, France"
        }
      ]
    },
    {
      "type": "radio",
      "name": "Radio",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "City"
        },
        {
          "type": "html",
          "id": "options",
          "label": "Options",
          "default": "New York, Toronto, Paris",
          "info": "Comma separated list of options. E.g: New York, Toronto, Paris"
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "presets": [
    {
      "name": "KS - Contact Form Builder",
      "blocks": [
        { "type": "email" },
        { "type": "input" },
        { "type": "phone" },
        { "type": "textarea" },
        { "type": "button" }
      ]
    }
  ]
}
{% endschema %}