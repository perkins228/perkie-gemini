{%- comment -%}
  Mobile Bottom Navigation
  Native-like bottom sheet navigation for mobile devices
  
  Usage:
  {% render 'mobile-bottom-navigation' %}
{%- endcomment -%}

<mobile-bottom-navigation>
  {%- comment -%} Bottom Navigation Bar {%- endcomment -%}
  <nav class="mobile-nav-bar" role="navigation" aria-label="{{ 'general.navigation.mobile' | t }}">
    {%- comment -%} Home {%- endcomment -%}
    <a href="{{ routes.root_url }}" class="mobile-nav-item" data-nav-id="home" aria-label="{{ 'general.navigation.home' | t }}">
      <div class="mobile-nav-icon">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      </div>
      <span class="mobile-nav-label">{{ 'general.navigation.home' | t }}</span>
    </a>
    
    {%- comment -%} Shop (with categories) {%- endcomment -%}
    <a href="{{ routes.all_products_collection_url }}" class="mobile-nav-item" data-nav-id="shop" data-trigger-sheet="shop" aria-label="{{ 'general.navigation.shop' | t }}">
      <div class="mobile-nav-icon">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </div>
      <span class="mobile-nav-label">{{ 'general.navigation.shop' | t }}</span>
    </a>
    
    {%- comment -%} My Pets {%- endcomment -%}
    <a href="#" class="mobile-nav-item" data-nav-id="my-pets" data-trigger-sheet="my-pets" aria-label="{{ 'general.navigation.my_pets' | t }}">
      <div class="mobile-nav-icon">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <span class="mobile-nav-label">{{ 'general.navigation.my_pets' | t }}</span>
    </a>
    
    {%- comment -%} Cart {%- endcomment -%}
    <a href="{{ routes.cart_url }}" class="mobile-nav-item" data-nav-id="cart" data-trigger-sheet="cart" aria-label="{{ 'general.navigation.cart' | t }}">
      <div class="mobile-nav-icon">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
        </svg>
        <span class="nav-badge" style="display: none;">0</span>
      </div>
      <span class="mobile-nav-label">{{ 'general.navigation.cart' | t }}</span>
    </a>
    
    {%- comment -%} Account {%- endcomment -%}
    <a href="{{ routes.account_url }}" class="mobile-nav-item" data-nav-id="account" aria-label="{{ 'general.navigation.account' | t }}">
      <div class="mobile-nav-icon">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
        </svg>
      </div>
      <span class="mobile-nav-label">{{ 'general.navigation.account' | t }}</span>
    </a>
    
    {%- comment -%} Active Indicator {%- endcomment -%}
    <div class="mobile-nav-indicator" aria-hidden="true"></div>
  </nav>
  
  {%- comment -%} Shop Categories Bottom Sheet {%- endcomment -%}
  <div class="bottom-sheet" data-sheet-id="shop" role="dialog" aria-labelledby="shop-sheet-title" aria-hidden="true">
    <div class="bottom-sheet-header">
      <h2 id="shop-sheet-title" class="bottom-sheet-title">{{ 'general.navigation.shop_categories' | t }}</h2>
      <button class="bottom-sheet-close" aria-label="{{ 'general.accessibility.close' | t }}">
        <svg width="20" height="20" fill="none" viewBox="0 0 20 20">
          <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 5l10 10M15 5L5 15"/>
        </svg>
      </button>
    </div>
    <div class="bottom-sheet-content">
      <div class="category-grid">
        {%- for collection in collections -%}
          {%- unless collection.handle == 'all' or collection.handle == 'frontpage' -%}
            <a href="{{ collection.url }}" class="category-item">
              {%- if collection.featured_image -%}
                <img src="{{ collection.featured_image | image_url: width: 200 }}" 
                     alt="{{ collection.title | escape }}"
                     loading="lazy"
                     width="200"
                     height="200">
              {%- endif -%}
              <span class="category-item-label">{{ collection.title }}</span>
            </a>
          {%- endunless -%}
        {%- endfor -%}
      </div>
    </div>
  </div>
  
  {%- comment -%} My Pets Bottom Sheet {%- endcomment -%}
  <div class="bottom-sheet" data-sheet-id="my-pets" role="dialog" aria-labelledby="pets-sheet-title" aria-hidden="true">
    <div class="bottom-sheet-header">
      <h2 id="pets-sheet-title" class="bottom-sheet-title">{{ 'general.navigation.my_pets' | t }}</h2>
      <button class="bottom-sheet-close" aria-label="{{ 'general.accessibility.close' | t }}">
        <svg width="20" height="20" fill="none" viewBox="0 0 20 20">
          <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 5l10 10M15 5L5 15"/>
        </svg>
      </button>
    </div>
    <div class="bottom-sheet-content">
      <div class="pets-gallery">
        {%- comment -%} Populated by JavaScript {%- endcomment -%}
        <div class="empty-state">
          <div class="empty-state-icon">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
              <circle cx="32" cy="32" r="12" stroke="currentColor" stroke-width="2"/>
              <path d="M32 28V36M32 40H32.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <h3>{{ 'general.pets.no_pets_title' | t }}</h3>
          <p>{{ 'general.pets.no_pets_description' | t }}</p>
          <a href="{{ routes.root_url }}pages/pet-background-remover" class="button button--primary">
            {{ 'general.pets.upload_pet_photo' | t }}
          </a>
        </div>
      </div>
    </div>
  </div>
  
  {%- comment -%} Cart Quick View Bottom Sheet {%- endcomment -%}
  <div class="bottom-sheet" data-sheet-id="cart" role="dialog" aria-labelledby="cart-sheet-title" aria-hidden="true">
    <div class="bottom-sheet-header">
      <h2 id="cart-sheet-title" class="bottom-sheet-title">{{ 'general.navigation.cart' | t }}</h2>
      <button class="bottom-sheet-close" aria-label="{{ 'general.accessibility.close' | t }}">
        <svg width="20" height="20" fill="none" viewBox="0 0 20 20">
          <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 5l10 10M15 5L5 15"/>
        </svg>
      </button>
    </div>
    <div class="bottom-sheet-content">
      {%- comment -%} Cart content will be loaded dynamically {%- endcomment -%}
      <div class="cart-items">
        <div class="empty-state">
          <div class="empty-state-icon">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
              <path d="M20 24h24l2 24H18l2-24z" stroke="currentColor" stroke-width="2"/>
              <path d="M28 24v-4a4 4 0 018 0v4" stroke="currentColor" stroke-width="2"/>
            </svg>
          </div>
          <h3>{{ 'general.cart.empty_title' | t }}</h3>
          <p>{{ 'general.cart.empty_description' | t }}</p>
          <a href="{{ routes.all_products_collection_url }}" class="button button--primary">
            {{ 'general.cart.continue_shopping' | t }}
          </a>
        </div>
      </div>
    </div>
  </div>
</mobile-bottom-navigation>

{%- comment -%} Initialize Mobile Navigation {%- endcomment -%}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const navigation = document.querySelector('mobile-bottom-navigation');
    if (navigation) {
      // Initialize cart quick view
      new CartQuickView(navigation);
      
      // Initialize my pets gallery
      new MyPetsGallery(navigation);
      
      // Listen for pet data updates
      window.addEventListener('storage', function(e) {
        if (e.key === 'userPetImages') {
          navigation.updateMyPetsIndicator();
          const gallery = new MyPetsGallery(navigation);
          gallery.initializeGallery();
        }
      });
    }
  });
</script>

<style>
  /* Add any theme-specific overrides here */
  :root {
    --mobile-nav-active-color: {{ settings.colors_accent_1 }};
    --gradient-background: {{ settings.gradient_background | default: settings.colors_accent_1 }};
  }
</style>