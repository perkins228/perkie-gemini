{%- style -%}
  #ks-simple-collections-{{ section.id }} {
    padding-top: {{ section.settings.pt | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.pb | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    #ks-simple-collections-{{ section.id }} {
      padding-top: {{ section.settings.pt }}px;
      padding-bottom: {{ section.settings.pb }}px;
    }
  }
{%- endstyle -%}

<ks-simple-collections
  id="ks-simple-collections-{{ section.id }}"
  class="ks-simple-collections color-{{ section.settings.color_scheme }} gradient"
>
  <div
    class="ks-section-header page-width"
  >
    {%- unless section.settings.title == blank -%}
      <h2
        class="
          title title-wrapper--no-top-margin inline-richtext
          {{ section.settings.heading_size }}
          {% if settings.animations_reveal_on_scroll %}scroll-trigger animate--slide-in{% endif %}
        "
      >
        {{ section.settings.title }}
      </h2>
    {%- endunless -%}
    {%- unless section.settings.description == blank -%}
      <div class="description rte {{ section.settings.description_size }} {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
        {{ section.settings.description }}
      </div>
    {%- endunless -%}
  </div>

  <div
    class="ks-simple-collections-list"
    role="list"
    aria-label="{{ section.settings.label }}"
  >
    {%- for block in section.blocks -%}
      <div
        class="
          ks-simple-collections-list-item
          {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}
          {% if block.settings.collection.id and block.settings.collection.handle == collection.handle %}active{% endif %}
        "
        {% if settings.animations_reveal_on_scroll %}
          data-cascade
          style="--animation-order: {{ forloop.index }};"
        {% endif %}
      >
        {% liquid
          assign img = block.settings.img | default: block.settings.collection.image
          assign title = block.settings.title | default: block.settings.collection.title

          assign img_size_times_2 = section.settings.item_img_size | times: 2

          if forloop.index <= 6
            assign img_placeholder = 'collection-' | append: forloop.index
          else
            assign img_placeholder = 'collection-1'
          endif
        %}
        <a
          class="full-unstyled-link"
          href="{{ block.settings.collection.url }}"
        >
          <div
            class="img-wrapper"
          >
            {% if img %}
              <img
                src="{{ img | image_url: width: img_size_times_2, height: img_size_times_2, crop: 'center' }}"
                class="img-fluid d-block"
                alt="{{ img.alt | escape }}"
                width="{{ section.settings.item_img_size }}"
                height="{{ section.settings.item_img_size }}"
                loading="lazy"
              >
            {% else %}
              {{ img_placeholder | placeholder_svg_tag: 'svg-placeholder' }}
            {% endif %}
          </div>
          {% if section.settings.item_show_title %}
            <h3 class="title {{ section.settings.item_title_font_size }} {% if section.settings.item_title_truncate %}text-truncate{% endif %}">
              {% if title %}
                {{ title | default: 'Collection title' }}
                {% if section.settings.item_show_product_count %}
                  ({{ block.settings.collection.products_count }})
                {% endif %}
              {% else %}
                Collection {{ forloop.index }}
              {% endif %}
            </h3>
          {% endif %}
        </a>
      </div>
    {%- endfor -%}
  </div>
</ks-simple-collections>

{% schema %}
{
  "name": "KS - Simple collections",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "General"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "inline_richtext",
      "id": "title",
      "label": "Heading",
      "default": "Shop by Collection"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "options": [
        { "value": "h2", "label": "Small" },
        { "value": "h1", "label": "Medium" },
        { "value": "h0", "label": "Large" },
        { "value": "hxl", "label": "Extra large" },
        { "value": "hxxl", "label": "Extra extra large" }
      ],
      "default": "h1"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>An optional description for this section</p>"
    },
    {
      "type": "select",
      "id": "description_size",
      "label": "Description size",
      "default": "fs-md",
      "options": [
        { "value": "fs-xs", "label": "xs" },
        { "value": "fs-sm", "label": "sm" },
        { "value": "fs-md", "label": "md" },
        { "value": "fs-lg", "label": "lg" },
        { "value": "fs-xl", "label": "xl" }
      ]
    },
    {
      "type": "text",
      "id": "label",
      "label": "List label",
      "info": "Needed for accessibility purposes",
      "default": "Featured collections"
    },
    {
      "type": "header",
      "content": "Collection item"
    },
    {
      "type": "range",
      "id": "item_img_size",
      "label": "Image size",
      "default": 120,
      "min": 50,
      "max": 300,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "item_show_title",
      "label": "Show title",
      "default": true
    },
    {
      "type": "select",
      "id": "item_title_font_size",
      "label": "Title font-size",
      "default": "fs-xs",
      "options": [
        { "value": "fs-xs", "label": "xs" },
        { "value": "fs-sm", "label": "sm" },
        { "value": "fs-md", "label": "md" },
        { "value": "fs-lg", "label": "lg" },
        { "value": "fs-xl", "label": "xl" }
      ]
    },
    {
      "type": "checkbox",
      "id": "item_title_truncate",
      "label": "Title truncate",
      "info": "Prevent titles from breaking into multiple lines",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "item_show_product_count",
      "label": "Show product count",
      "default": true
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "pt",
      "label": "Top",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 36,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "pb",
      "label": "Bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 36,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "img",
          "label": "Image",
          "info": "Optional - Leave empty to use the default collection image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "info": "Optional - Leave empty to use the default collection title"
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "presets": [
    {
      "name": "KS - Simple collections",
      "blocks": [
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" }
      ]
    }
  ]
}
{% endschema %}
